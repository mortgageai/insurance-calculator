// openai.js - –ß–∏—Å—Ç—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤
async function processClientRequest(message) {
  try {
    // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∏ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å
    const result = handleClientRequest(message);

    console.log('processClientRequest result type:', typeof result);
    console.log('processClientRequest result:', result);

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    if (result && typeof result === 'string' && (result.includes('üö´') || result.includes('‚ùå –ù–∞–π–¥–µ–Ω—ã –æ—à–∏–±–∫–∏'))) {
      // –≠—Ç–æ –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
      return result;
    } else if (result && typeof result === 'string' && (result.includes('–ë–∞–Ω–∫:') || result.includes('–†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ä–æ—á–∫–∏'))) {
      // –≠—Ç–æ —É—Å–ø–µ—à–Ω—ã–π —Ä–∞—Å—á–µ—Ç (–æ–±—ã—á–Ω—ã–π –∏–ª–∏ —Ä–∞—Å—Å—Ä–æ—á–∫–∞)
      return result;
    } else {
      // –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
      return `<div style="color: #dc3545; padding: 15px; border: 1px solid #dc3545; border-radius: 8px; margin: 15px 0; background-color: #f8d7da;">
        <strong>‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞</strong><br><br>
        –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è.<br><br>
        <strong>üìã –£–∫–∞–∂–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:</strong>
        <ul style="margin: 10px 0; padding-left: 20px;">
          <li>–ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞ (–°–±–µ—Ä–±–∞–Ω–∫, –í–¢–ë, –î–æ–º.–†–§ –∏ —Ç.–¥.)</li>
          <li>–û–°–ó (–æ—Å—Ç–∞—Ç–æ–∫ —Å—Å—É–¥–Ω–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏)</li>
          <li>–î–∞–Ω–Ω—ã–µ –∑–∞–µ–º—â–∏–∫–∞ (–ø–æ–ª –∏ –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)</li>
          <li>–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞ (–∫–≤–∞—Ä—Ç–∏—Ä–∞/–¥–æ–º)</li>
        </ul>
        <strong>üí° –ü—Ä–∏–º–µ—Ä:</strong> "–í–¢–ë –æ—Å—Ç 3000000 –º—É–∂ 15.08.1985 –¥–æ–º –∫–∏—Ä–ø–∏—á"
      </div>`;
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:', error);
    return `<div style="color: #dc3545; padding: 15px; border: 1px solid #dc3545; border-radius: 8px; margin: 15px 0; background-color: #f8d7da;">
      <strong>‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞</strong><br><br>
      –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
    </div>`;
  }
}

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å
window.processClientRequest = processClientRequest;
