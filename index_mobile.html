<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</title>
  <meta name="description" content="–ë—ã—Å—Ç—Ä—ã–π —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è">

  <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <link rel="stylesheet" href="ingosstrax_mobile.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Roboto', Arial, sans-serif;
      background: #f8fafc;
      color: #1a1a1a;
      min-height: 100vh;
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>

<body>
  <!-- –®–∞–ø–∫–∞ -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <div class="logo-icon">üèõÔ∏è</div>
        <div class="logo-text">
          <p>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</p>
        </div>
      </div>
    </div>
  </header>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <main class="main">
    <!-- –ë–ª–æ–∫ —Ä–∞—Å—á–µ—Ç–∞ -->
    <section class="calc-section">
      <div class="calc-card">
        <h2 class="section-title">üí∞ –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h2>

        <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
        <div class="input-group">
          <label class="input-label">–î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞</label>
          <div class="input-wrapper">
            <textarea
              id="client-input"
              placeholder="–ü—Ä–∏–º–µ—Ä: –í–¢–ë –æ—Å—Ç 3000000 –º—É–∂ 15.08.1985 –∫–≤–∞—Ä—Ç–∏—Ä–∞"
              rows="3"
              maxlength="1000"
            ></textarea>
          </div>
          <div class="input-help">
            <span class="help-icon">üí°</span>
            –£–∫–∞–∂–∏—Ç–µ –±–∞–Ω–∫, –û–°–ó, –¥–∞–Ω–Ω—ã–µ –∑–∞–µ–º—â–∏–∫–∞, —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class="button-group">
          <button id="calculate-btn" class="btn-primary">
            <span class="btn-icon">‚ö°</span>
            –†–∞—Å—Å—á–∏—Ç–∞—Ç—å
          </button>
          <button id="clear-btn" class="btn-secondary">
            <span class="btn-icon">üóëÔ∏è</span>
            –û—á–∏—Å—Ç–∏—Ç—å
          </button>
        </div>
        <div class="button-group" style="margin-top: 12px;">
          <button id="underwriting-btn" class="btn-underwriting">
            <span class="btn-icon">üîç</span>
            –ê–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥
          </button>
        </div>
        <div class="underwriting-info">
          <p>–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–æ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –æ–¥–æ–±—Ä–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</p>
        </div>
      </div>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
      <div id="results-section" class="results-section" style="display: none;">
        <div class="results-card">
          <h3 class="results-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h3>
          <div id="results-content" class="results-content"></div>
        </div>
      </div>
    </section>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–Ω–∫–∞—Ö -->
    <section class="banks-section">
      <h3 class="section-title-mini">üè¶ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –±–∞–Ω–∫–∏</h3>
      <div class="banks-grid">
        <div class="bank-item">–°–±–µ—Ä–±–∞–Ω–∫</div>
        <div class="bank-item">–í–¢–ë</div>
        <div class="bank-item">–î–æ–º.–†–§</div>
        <div class="bank-item">–ê–ª—å—Ñ–∞ –ë–∞–Ω–∫</div>
        <div class="bank-item">–¢–∏–º–µ—Ä –ë–∞–Ω–∫</div>
        <div class="bank-item">–ú–µ—Ç–∞–ª–ª–∏–Ω–≤–µ—Å—Ç</div>
        <div class="bank-item">–†–æ—Å–±–∞–Ω–∫</div>
        <div class="bank-item">–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω</div>
        <div class="bank-item">–ü—Ä–æ–º—Å–≤—è–∑—å–±–∞–Ω–∫</div>
        <div class="bank-item">–ê–∫ –ë–∞—Ä—Å</div>
        <div class="bank-item">–ó–µ–Ω–∏—Ç</div>
        <div class="bank-item">–ò–¢–ë/–¢–ö–ë</div>
        <div class="bank-item">–£–ë–†–ò–†</div>
        <div class="bank-item">–£—Ä–∞–ª—Å–∏–±</div>
        <div class="bank-item">–Æ–Ω–∏–∫—Ä–µ–¥–∏—Ç</div>
        <div class="bank-item">–†–°–•–ë</div>
        <div class="bank-item">–°–æ–≤–∫–æ–º–±–∞–Ω–∫</div>
        <div class="bank-item">–°–±–µ—Ä–±–∞–Ω–∫</div>
      </div>
    </section>

    <!-- –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ -->
    <section class="format-section">
      <h3 class="section-title-mini">üìã –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
      <div class="format-grid">
        <div class="format-item">
          <div class="format-icon">üèõÔ∏è</div>
          <div class="format-content">
            <strong>–ë–∞–Ω–∫</strong>
            <p>–°–±–µ—Ä–±–∞–Ω–∫, –í–¢–ë, –î–æ–º.–†–§ –∏ –¥—Ä.</p>
          </div>
        </div>
        <div class="format-item">
          <div class="format-icon">üí∞</div>
          <div class="format-content">
            <strong>–û–°–ó</strong>
            <p>–û—Å—Ç–∞—Ç–æ–∫ —Å—Å—É–¥–Ω–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏</p>
          </div>
        </div>
        <div class="format-item">
          <div class="format-icon">üë§</div>
          <div class="format-content">
            <strong>–ó–∞–µ–º—â–∏–∫</strong>
            <p>–º—É–∂/–∂–µ–Ω DD.MM.YYYY</p>
          </div>
        </div>
        <div class="format-item">
          <div class="format-icon">üè†</div>
          <div class="format-content">
            <strong>–û–±—ä–µ–∫—Ç</strong>
            <p>–∫–≤–∞—Ä—Ç–∏—Ä–∞, –¥–æ–º –∫–∏—Ä–ø–∏—á/–¥–µ—Ä–µ–≤–æ</p>
          </div>
        </div>
      </div>
    </section>

    <!-- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ -->
    <section class="advantages-section">
      <h3 class="section-title-mini">‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h3>
      <div class="advantages-grid">
        <div class="advantage-item">
          <div class="advantage-icon">‚ö°</div>
          <h4>–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç</h4>
          <p>–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ —Å–µ–∫—É–Ω–¥—ã</p>
        </div>
        <div class="advantage-item">
          <div class="advantage-icon">üéØ</div>
          <h4>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</h4>
          <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã</p>
        </div>
        <div class="advantage-item">
          <div class="advantage-icon">üõ°Ô∏è</div>
          <h4>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</h4>
          <p>–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã</p>
        </div>
        <div class="advantage-item">
          <div class="advantage-icon">üì±</div>
          <h4>–£–¥–æ–±—Å—Ç–≤–æ</h4>
          <p>–†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ</p>
        </div>
      </div>
    </section>
  </main>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ê–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥–∞ -->
  <div id="underwriting-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>üîç –ê–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥ - –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤</h3>
        <button class="modal-close" onclick="window.closeUnderwritingModal()">√ó</button>
      </div>

      <div class="modal-body">
        <div class="underwriting-notice">
          <div class="notice-icon">‚ÑπÔ∏è</div>
          <div class="notice-text">
            <strong>–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–æ–≤</strong><br>
            –ü–æ–º–æ–≥–∞–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ–¥–æ–±—Ä–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è –∂–∏–∑–Ω–∏ –∏ –∏–º—É—â–µ—Å—Ç–≤–∞
          </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs-container">
          <div class="tab-buttons">
            <button class="tab-btn active" data-tab="health" onclick="window.switchTab('health')">üè• –ú–µ–¥.</button>
            <button class="tab-btn" data-tab="wear" onclick="window.switchTab('wear')">üè¢ –ò–∑–Ω–æ—Å</button>
            <button class="tab-btn" data-tab="egrn" onclick="window.switchTab('egrn')">üè† –ï–ì–†–ù</button>
            <button class="tab-btn" data-tab="bankruptcy" onclick="window.switchTab('bankruptcy')">‚öñÔ∏è –ë–∞–Ω–∫—Ä.</button>
            <button class="tab-btn" data-tab="fssp" onclick="window.switchTab('fssp')">üöî –§–°–°–ü</button>
          </div>

          <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–æ–∫ -->
          <div class="tab-content active" id="health-content">
            <div class="tab-description">
              <h4>üè• –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥</h4>
              <p>–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –ø–æ –∏–Ω–¥–µ–∫—Å—É –º–∞—Å—Å—ã —Ç–µ–ª–∞ (–ò–ú–¢) –∏ –≤–æ–∑—Ä–∞—Å—Ç—É –∑–∞–µ–º—â–∏–∫–∞</p>
            </div>

            <div class="form-section">
              <div class="form-group">
                <label for="health-birth">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
                <input type="date" id="health-birth" required>
              </div>
              <div class="form-group">
                <label for="health-height">–†–æ—Å—Ç (—Å–º):</label>
                <input type="number" id="health-height" placeholder="175" min="120" max="220" required>
              </div>
              <div class="form-group">
                <label for="health-weight">–í–µ—Å (–∫–≥):</label>
                <input type="number" id="health-weight" placeholder="70" min="30" max="200" required>
              </div>
            </div>
            <div class="tab-actions">
              <button class="btn-check" id="health-calculate-btn">
                <span class="btn-icon">üìä</span>
                <span>–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</span>
              </button>
            </div>
            <div id="health-results" class="check-results"></div>
          </div>

          <div class="tab-content" id="wear-content">
            <div class="tab-description">
              <h4>üè¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–Ω–æ—Å–∞ –∑–¥–∞–Ω–∏—è</h4>
              <p>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –∏–∑–Ω–æ—Å–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∑–¥–∞–Ω–∏—è –∏ –¥–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ü–µ–Ω–∫–∏</p>
            </div>

            <div class="form-section">
              <div class="form-group">
                <label for="wear-city">–ì–æ—Ä–æ–¥:</label>
                <input type="text" id="wear-city" placeholder="–ú–æ—Å–∫–≤–∞" required>
              </div>
              <div class="form-group">
                <label for="wear-street">–£–ª–∏—Ü–∞:</label>
                <input type="text" id="wear-street" placeholder="–õ–µ–Ω–∏–Ω–∞" required>
              </div>
              <div class="form-group">
                <label for="wear-house">–î–æ–º:</label>
                <input type="text" id="wear-house" placeholder="15" required>
              </div>
              <div class="form-group">
                <label for="wear-percent">–ò–∑–Ω–æ—Å –∑–¥–∞–Ω–∏—è (%):</label>
                <input type="number" id="wear-percent" placeholder="25" min="0" max="100" step="0.1" required>
                <div class="field-hint">
                  <small>–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç –∏–∑–Ω–æ—Å–∞ –∑–¥–∞–Ω–∏—è (0-100). –î–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ —Å–∞–π—Ç–µ dom.mingkh.ru</small>
                </div>
              </div>
            </div>
            <div class="tab-actions">
              <button class="btn-check" id="wear-calculate-btn">
                <span class="btn-icon">üìä</span>
                <span>–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–∏—Å–∫</span>
              </button>
            </div>
            <div id="wear-results" class="check-results"></div>
          </div>

          <div class="tab-content" id="egrn-content">
            <div class="tab-description">
              <h4>üè† –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –ï–ì–†–ù</h4>
              <p>–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–∏—Å–∫–∏ –ï–ì–†–ù –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–∞–≤, –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–π –∏ —Ä–µ—à–µ–Ω–∏–π –æ–± –∏–∑—ä—è—Ç–∏–∏</p>
            </div>
            <div class="form-section">
              <div class="form-group">
                <label for="egrn-file">–§–∞–π–ª –≤—ã–ø–∏—Å–∫–∏ –ï–ì–†–ù (.xml):</label>
                <input type="file" id="egrn-file" accept=".xml" required>
                <div class="file-hint">
                  <small>–ó–∞–≥—Ä—É–∑–∏—Ç–µ XML —Ñ–∞–π–ª –≤—ã–ø–∏—Å–∫–∏ –∏–∑ –†–æ—Å—Ä–µ–µ—Å—Ç—Ä–∞</small>
                </div>
              </div>
            </div>
            <div class="tab-actions">
              <button class="btn-check" onclick="window.checkEGRN()">
                <span class="btn-icon">üìã</span>
                <span>–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</span>
              </button>
            </div>
            <div id="egrn-results" class="check-results"></div>
          </div>

          <div class="tab-content" id="bankruptcy-content">
            <div class="tab-description">
              <h4>‚öñÔ∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ</h4>
              <p>–ü–æ–∏—Å–∫ –¥–µ–ª –æ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–µ –ø–æ –§–ò–û –≤ –ï–§–†–°–ë</p>
            </div>
            <div class="form-section">
              <div class="form-group">
                <label for="bankruptcy-fio">–§–ò–û –ø–æ–ª–Ω–æ—Å—Ç—å—é:</label>
                <input type="text" id="bankruptcy-fio" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" required>
              </div>
            </div>
            <div class="tab-actions">
              <button class="btn-check" onclick="window.checkBankruptcy()">
                <span class="btn-icon">‚öñÔ∏è</span>
                <span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</span>
              </button>
            </div>
            <div id="bankruptcy-results" class="check-results"></div>
          </div>

          <div class="tab-content" id="fssp-content">
            <div class="tab-description">
              <h4>üöî –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –§–°–°–ü</h4>
              <p>–ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤ –∏ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–µ–π –≤ –§–°–°–ü</p>
            </div>
            <div class="form-section">
              <div class="form-group">
                <label for="fssp-fio">–§–ò–û –ø–æ–ª–Ω–æ—Å—Ç—å—é:</label>
                <input type="text" id="fssp-fio" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" required>
              </div>
              <div class="form-group">
                <label for="fssp-birth">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
                <input type="date" id="fssp-birth" required>
              </div>
              <div class="form-group">
                <label for="fssp-region">–°—É–±—ä–µ–∫—Ç –†–§:</label>
                <select id="fssp-region" required>
                  <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω</option>
                  <option value="77">–≥. –ú–æ—Å–∫–≤–∞</option>
                  <option value="78">–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
                  <option value="50">–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="16">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω</option>
                  <option value="01">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–¥—ã–≥–µ—è</option>
                  <option value="02">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω</option>
                  <option value="03">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë—É—Ä—è—Ç–∏—è</option>
                  <option value="04">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–ª—Ç–∞–π</option>
                  <option value="05">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –î–∞–≥–µ—Å—Ç–∞–Ω</option>
                  <option value="06">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ò–Ω–≥—É—à–µ—Ç–∏—è</option>
                  <option value="07">–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞</option>
                  <option value="08">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è</option>
                  <option value="09">–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞</option>
                  <option value="10">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞—Ä–µ–ª–∏—è</option>
                  <option value="11">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–æ–º–∏</option>
                  <option value="12">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–∞—Ä–∏–π –≠–ª</option>
                  <option value="13">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–æ—Ä–¥–æ–≤–∏—è</option>
                  <option value="14">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)</option>
                  <option value="15">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è - –ê–ª–∞–Ω–∏—è</option>
                  <option value="17">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢—ã–≤–∞</option>
                  <option value="18">–£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞</option>
                  <option value="19">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –•–∞–∫–∞—Å–∏—è</option>
                  <option value="20">–ß–µ—á–µ–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞</option>
                  <option value="21">–ß—É–≤–∞—à—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞</option>
                  <option value="22">–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="23">–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="24">–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="25">–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="26">–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="27">–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="28">–ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="29">–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="30">–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="31">–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="32">–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="33">–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="34">–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="35">–í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="36">–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="37">–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="38">–ò—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="39">–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="40">–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="41">–ö–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="42">–ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="43">–ö–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="44">–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="45">–ö—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="46">–ö—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="47">–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="48">–õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="49">–ú–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="51">–ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="52">–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="53">–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="54">–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="55">–û–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="56">–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="57">–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="58">–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="59">–ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="60">–ü—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="61">–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="62">–†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="63">–°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="64">–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="65">–°–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="66">–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="67">–°–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="68">–¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="69">–¢–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="70">–¢–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="71">–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="72">–¢—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="73">–£–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="74">–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="75">–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π</option>
                  <option value="76">–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="79">–ï–≤—Ä–µ–π—Å–∫–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                  <option value="82">–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö—Ä—ã–º</option>
                  <option value="83">–≥. –°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å</option>
                  <option value="84">–ù–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥</option>
                  <option value="85">–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥ - –Æ–≥—Ä–∞</option>
                  <option value="86">–ß—É–∫–æ—Ç—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥</option>
                  <option value="87">–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥</option>
                </select>
              </div>
            </div>
            <div class="tab-actions">
              <button class="btn-check" onclick="window.checkFSSP()">
                <span class="btn-icon">üöî</span>
                <span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</span>
              </button>
            </div>
            <div id="fssp-results" class="check-results"></div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-secondary" onclick="window.closeUnderwritingModal()">
          <span>–ó–∞–∫—Ä—ã—Ç—å</span>
        </button>
      </div>
    </div>
  </div>

  <!-- –ü–æ–¥–≤–∞–ª -->
  <footer class="footer">
    <p>&copy; 2026 –ò–ø–æ—Ç–µ—á–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </footer>

  <script>
    // –§—É–Ω–∫—Ü–∏–∏ –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥–∞ - –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ä–∞–∑—É, —á—Ç–æ–±—ã –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≥–ª–æ–±–∞–ª—å–Ω–æ
    window.openUnderwritingModal = function() {
      const modal = document.getElementById('underwriting-modal');
      if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        if (typeof window.switchTab === 'function') {
          window.switchTab('health');
        }
      } else {
        console.error('Modal element not found');
      }
    };

    window.closeUnderwritingModal = function() {
      const modal = document.getElementById('underwriting-modal');
      if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
        if (typeof window.clearAllResults === 'function') {
          window.clearAllResults();
        }
      }
    };

    window.switchTab = function(tabId) {
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      const tabContent = document.getElementById(tabId + '-content');
      if (tabContent) {
        tabContent.classList.add('active');
      }
      const tabBtn = document.querySelector(`[data-tab="${tabId}"]`);
      if (tabBtn) {
        tabBtn.classList.add('active');
      }
      if (typeof window.clearAllResults === 'function') {
        window.clearAllResults();
      }
    };

    window.clearAllResults = function() {
      const resultContainers = ['health-results', 'wear-results', 'egrn-results', 'bankruptcy-results', 'fssp-results'];
      resultContainers.forEach(id => {
        const container = document.getElementById(id);
        if (container) container.innerHTML = '';
      });
    };

    // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
    function initMobileCalculator() {
      const clientInput = document.getElementById('client-input');
      const calculateBtn = document.getElementById('calculate-btn');
      const clearBtn = document.getElementById('clear-btn');
      const resultsSection = document.getElementById('results-section');
      const resultsContent = document.getElementById('results-content');

      // Touch-friendly –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
      calculateBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        this.style.transform = 'scale(0.95)';
      });

      calculateBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        this.style.transform = 'scale(1)';
        calculate();
      });

      clearBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        this.style.transform = 'scale(0.95)';
      });

      clearBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        this.style.transform = 'scale(1)';
        clearData();
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥–∞
      const underwritingBtn = document.getElementById('underwriting-btn');
      if (underwritingBtn) {
        console.log('Underwriting button found, setting up handlers');
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function openModal() {
          console.log('openModal called');
          const modal = document.getElementById('underwriting-modal');
          console.log('Modal element:', modal);
          if (modal) {
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            console.log('Modal opened');
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–µ—Ä–≤—É—é –≤–∫–ª–∞–¥–∫—É
            if (typeof window.switchTab === 'function') {
              window.switchTab('health');
            } else {
              // Fallback: –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∫–ª–∞–¥–∫—É –Ω–∞–ø—Ä—è–º—É—é
              const healthTab = document.querySelector('[data-tab="health"]');
              const healthContent = document.getElementById('health-content');
              if (healthTab && healthContent) {
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                healthTab.classList.add('active');
                healthContent.classList.add('active');
              }
            }
          } else {
            console.error('Modal not found!');
          }
        }

        // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        const newBtn = underwritingBtn.cloneNode(true);
        underwritingBtn.parentNode.replaceChild(newBtn, underwritingBtn);

        // Touch-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        newBtn.addEventListener('touchstart', function(e) {
          console.log('Touch start on underwriting button');
          e.preventDefault();
          e.stopPropagation();
          this.style.transform = 'scale(0.95)';
          this.style.opacity = '0.8';
        }, { passive: false });

        newBtn.addEventListener('touchend', function(e) {
          console.log('Touch end on underwriting button');
          e.preventDefault();
          e.stopPropagation();
          this.style.transform = 'scale(1)';
          this.style.opacity = '1';
          openModal();
        }, { passive: false });

        newBtn.addEventListener('touchcancel', function(e) {
          this.style.transform = 'scale(1)';
          this.style.opacity = '1';
        });

        // Click-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–æ–≤
        newBtn.addEventListener('click', function(e) {
          console.log('Click on underwriting button');
          e.preventDefault();
          e.stopPropagation();
          openModal();
        });

        // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ mousedown –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
        newBtn.addEventListener('mousedown', function(e) {
          e.preventDefault();
        });
      } else {
        console.error('Underwriting button not found!');
      }

      // –ö–ª–∏–∫ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–æ–≤
      calculateBtn.addEventListener('click', calculate);
      clearBtn.addEventListener('click', clearData);

      // Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
      clientInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          calculate();
        }
      });

      async function calculate() {
        const message = clientInput.value.trim();

        if (!message) {
          showError('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞');
          return;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ª–∏ —Å–∫—Ä–∏–ø—Ç—ã
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º processClientRequest –∫–∞–∫ –≤ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–π –≤–µ—Ä—Å–∏–∏, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞, –∏–Ω–∞—á–µ handleClientRequest
        const processFunction = typeof processClientRequest !== 'undefined' ? processClientRequest : 
                                (typeof handleClientRequest !== 'undefined' ? handleClientRequest : null);

        if (!processFunction) {
          showError('–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É.');
          return;
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
        calculateBtn.disabled = true;
        calculateBtn.innerHTML = '<span class="loading">‚è≥</span> –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º...';

        try {
          // –ò—Å–ø–æ–ª—å–∑—É–µ–º async/await –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è, –∏–Ω–∞—á–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤
          let result;
          if (typeof processFunction === 'function' && processFunction.constructor.name === 'AsyncFunction') {
            result = await processFunction(message);
          } else {
            result = processFunction(message);
          }

          // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç - –µ—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ —Å HTML, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
          if (result && typeof result === 'string') {
            // –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç HTML —Ç–µ–≥–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –µ—Å—Ç—å
            if (result.includes('<') && result.includes('>')) {
              resultsContent.innerHTML = result;
            } else {
              resultsContent.innerHTML = result.replace(/\n/g, '<br>');
            }
          } else {
            resultsContent.innerHTML = String(result).replace(/\n/g, '<br>');
          }
          
          resultsSection.style.display = 'block';

          // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
          setTimeout(() => {
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }, 100);

        } catch (error) {
          console.error('–û—à–∏–±–∫–∞:', error);
          showError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.');
        } finally {
          calculateBtn.disabled = false;
          calculateBtn.innerHTML = '<span class="btn-icon">‚ö°</span> –†–∞—Å—Å—á–∏—Ç–∞—Ç—å';
        }
      }

      function clearData() {
        clientInput.value = '';
        resultsSection.style.display = 'none';
        resultsContent.innerHTML = '';
        clientInput.focus();
      }

      function showError(message) {
        resultsContent.innerHTML = `<div class="error-message">
          <div class="error-icon">‚ùå</div>
          <div class="error-text">${message}</div>
        </div>`;
        resultsSection.style.display = 'block';
      }

      // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      setTimeout(() => {
        clientInput.focus();
      }, 500);
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
    function checkScriptsLoaded() {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (processClientRequest –∏–ª–∏ handleClientRequest)
      const hasProcessFunction = typeof processClientRequest !== 'undefined' || typeof handleClientRequest !== 'undefined';
      const hasParser = typeof parseTextToObject !== 'undefined';
      const hasCalculator = typeof performCalculations !== 'undefined';
      
      if (hasProcessFunction && hasParser && hasCalculator) {
        console.log('All scripts loaded, initializing calculator');
        initMobileCalculator();
      } else {
        console.log('Waiting for scripts...', {
          processClientRequest: typeof processClientRequest,
          handleClientRequest: typeof handleClientRequest,
          parseTextToObject: typeof parseTextToObject,
          performCalculations: typeof performCalculations
        });
        setTimeout(checkScriptsLoaded, 100);
      }
    }

    // –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    document.addEventListener('DOMContentLoaded', function() {
      checkScriptsLoaded();
    });

    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º zoom –Ω–∞ iOS
    document.addEventListener('gesturestart', function(e) {
      e.preventDefault();
    });
  </script>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏–∫—É -->
  <script src="config_banks.js?v=17"></script>
  <script src="tariffs_life.js?v=16"></script>
  <script src="tariffs_property.js?v=16"></script>
  <script src="tariffs_ifl.js?v=16"></script>
  <script src="parser.js?v=19"></script>
  <script src="calculator_v2.js?v=23"></script>
  <script src="installment_calculator.js?v=5"></script>
  <script src="openai.js?v=17"></script>

  <!-- JavaScript –¥–ª—è –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥–∞ -->
  <script>
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (—É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—ã—à–µ, –Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

    function showResult(containerId, result) {
      const container = document.getElementById(containerId);
      if (!container) return;

      const riskClass = result.risk === 'normal' ? 'success' : 
                       result.risk === 'medium' ? 'warning' : 
                       result.risk === 'high' ? 'error' : 'error';

      const riskLevelClass = result.risk === 'normal' ? 'risk-low' : 
                            result.risk === 'medium' ? 'risk-medium' : 'risk-high';

      container.innerHTML = `
        <div class="result-item ${riskClass}">
          <div class="result-icon">${result.icon || 'üìä'}</div>
          <div class="result-content">
            <strong>${result.title || '–†–µ–∑—É–ª—å—Ç–∞—Ç'}</strong>
            <p style="white-space: pre-line;">${result.message || ''}</p>
            ${result.details ? `<p style="margin-top: 8px; color: #64748b; font-size: 13px;">${result.details}</p>` : ''}
            ${result.riskLevel ? `<span class="risk-level ${riskLevelClass}">${result.riskLevel}</span>` : ''}
          </div>
        </div>
      `;
    }

    function showLoading(containerId, message) {
      const container = document.getElementById(containerId);
      if (!container) return;
      container.innerHTML = `
        <div class="result-item loading">
          <div class="result-icon">‚è≥</div>
          <div class="result-content">
            <strong>–ó–∞–≥—Ä—É–∑–∫–∞...</strong>
            <p>${message || '–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...'}</p>
          </div>
        </div>
      `;
    }

    // –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥
    async function calculateHealthUnderwriting() {
      const birthDate = document.getElementById('health-birth').value;
      const height = parseInt(document.getElementById('health-height').value);
      const weight = parseInt(document.getElementById('health-weight').value);

      if (!birthDate || !height || !weight) {
        showResult('health-results', {
          icon: '‚ö†Ô∏è',
          title: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö',
          message: '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è: –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, —Ä–æ—Å—Ç –∏ –≤–µ—Å',
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
        return;
      }

      showLoading('health-results', '–í—ã–ø–æ–ª–Ω—è–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥...');

      try {
        const age = calculateAgeForModal(birthDate);
        if (age === null || isNaN(age)) {
          throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤–æ–∑—Ä–∞—Å—Ç –∏–∑ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è');
        }
        const bmi = weight / ((height / 100) ** 2);
        const underwritingFactor = getUnderwritingFactor(age, height, weight);

        let result, risk, riskLevel, message, recommendation;

        if (underwritingFactor === '–ú–ï–î–û') {
          result = '–ú–ï–î–û';
          risk = 'high';
          riskLevel = '–¢—Ä–µ–±—É–µ—Ç—Å—è –º–µ–¥–æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ';
          message = '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–π—Ç–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ';
          recommendation = '–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –≤—Ä–∞—á—É –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ–º';
        } else if (underwritingFactor === 1.25) {
          result = '+25% –∫ —Ç–∞—Ä–∏—Ñ—É';
          risk = 'medium';
          riskLevel = '–ü–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ç–∞—Ä–∏—Ñ';
          message = '–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞–¥–±–∞–≤–∫–∞ 25% –∫ –±–∞–∑–æ–≤–æ–º—É —Ç–∞—Ä–∏—Ñ—É';
          recommendation = '–¢–∞—Ä–∏—Ñ –±—É–¥–µ—Ç —É–≤–µ–ª–∏—á–µ–Ω –Ω–∞ 25% –∏–∑-–∑–∞ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ —Ä–∏—Å–∫–∞';
        } else {
          result = '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ';
          risk = 'normal';
          riskLevel = '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∏—Å–∫';
          message = '–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è';
          recommendation = '–†–∏—Å–∫ –≤ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è';
        }

        showResult('health-results', {
          icon: result === '–ú–ï–î–û' ? 'üè•' : result === '+25% –∫ —Ç–∞—Ä–∏—Ñ—É' ? '‚ö†Ô∏è' : '‚úÖ',
          title: '–†–µ–∑—É–ª—å—Ç–∞—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥–∞',
          message: `–í–æ–∑—Ä–∞—Å—Ç: ${age} –ª–µ—Ç\n–ò–ú–¢: ${bmi.toFixed(1)}\n–†–µ–∑—É–ª—å—Ç–∞—Ç: ${result}\n\n${message}`,
          details: recommendation,
          risk: risk,
          riskLevel: riskLevel
        });
      } catch (error) {
        showResult('health-results', {
          icon: '‚ùå',
          title: '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞',
          message: '–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥',
          details: error.message,
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
      }
    }

    // –ò—Å–ø–æ–ª—å–∑—É–µ–º calculateAge –∏–∑ parser.js, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏—Ç DD.MM.YYYY
    // –§—É–Ω–∫—Ü–∏—è window.calculateAge —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ parser.js –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç DD.MM.YYYY
    function calculateAgeForModal(birthDate) {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º window.calculateAge –∏–∑ parser.js –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ DD.MM.YYYY
      if (window.calculateAge) {
        return window.calculateAge(birthDate, null);
      }
      // Fallback: –∏—Å–ø–æ–ª—å–∑—É–µ–º parseDateDMY –Ω–∞–ø—Ä—è–º—É—é
      if (window.parseDateDMY) {
        const birth = window.parseDateDMY(birthDate);
        if (!birth || isNaN(birth.getTime())) {
          console.warn('Failed to parse birth date:', birthDate);
          return null;
        }
        const today = new Date();
        let age = today.getFullYear() - birth.getFullYear();
        const monthDiff = today.getMonth() - birth.getMonth();
        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
          age--;
        }
        return age;
      }
      // –ü–æ—Å–ª–µ–¥–Ω–∏–π fallback: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Date (–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è DD.MM.YYYY)
      const today = new Date();
      const birth = new Date(birthDate);
      if (isNaN(birth.getTime())) {
        return null;
      }
      let age = today.getFullYear() - birth.getFullYear();
      const monthDiff = today.getMonth() - birth.getMonth();
      if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
        age--;
      }
      return age;
    }

    // –¢–∞–±–ª–∏—Ü–∞ –∞–Ω–¥–µ—Ä—Ä–∞–π—Ç–∏–Ω–≥–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
    window.UNDERWRITING_TABLE = {
      140: {
        "16-29": [1.25, 1.00, 1.00, 1.00, 1.00, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "30-45": [1.25, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "46-59": [1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "59": [1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"]
      },
      150: {
        "16-29": ["–ú–ï–î–û", 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "30-45": ["–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "46-59": ["–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "59": ["–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"]
      },
      160: {
        "16-29": ["–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "30-45": ["–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "46-59": ["–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "59": ["–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"]
      },
      170: {
        "16-29": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "30-45": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "46-59": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "59": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"]
      },
      180: {
        "16-29": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "30-45": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "46-59": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "59": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"]
      },
      190: {
        "16-29": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "30-45": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "46-59": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"],
        "59": ["–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", 1.25, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.25, 1.25, 1.25, "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û", "–ú–ï–î–û"]
      }
    };

    function getUnderwritingFactor(age, height, weight) {
      const ageGroup = age >= 16 && age <= 29 ? "16-29" :
                      age >= 30 && age <= 45 ? "30-45" :
                      age >= 46 && age <= 59 ? "46-59" : "59";

      const heightKeys = Object.keys(window.UNDERWRITING_TABLE).map(Number).sort((a, b) => a - b);
      const closestHeight = heightKeys.reduce((prev, curr) => 
        Math.abs(curr - height) < Math.abs(prev - height) ? curr : prev
      );

      const weightRanges = [39, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140];
      let weightIndex = 0;
      for (let i = 0; i < weightRanges.length; i++) {
        if (weight < weightRanges[i]) {
          weightIndex = i;
          break;
        }
        if (i === weightRanges.length - 1) weightIndex = weightRanges.length;
      }

      if (!window.UNDERWRITING_TABLE[closestHeight] || !window.UNDERWRITING_TABLE[closestHeight][ageGroup]) {
        return 1.00;
      }

      return window.UNDERWRITING_TABLE[closestHeight][ageGroup][weightIndex] || 1.00;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–Ω–æ—Å–∞ –∑–¥–∞–Ω–∏—è
    async function calculateBuildingRisk() {
      const city = document.getElementById('wear-city')?.value.trim();
      const street = document.getElementById('wear-street')?.value.trim();
      const house = document.getElementById('wear-house')?.value.trim();
      const wearPercent = parseFloat(document.getElementById('wear-percent')?.value);

      if (!city || !street || !house || !wearPercent) {
        showResult('wear-results', {
          icon: '‚ö†Ô∏è',
          title: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö',
          message: '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è',
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
        return;
      }

      showLoading('wear-results', '–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∑–¥–∞–Ω–∏–∏...');

      try {
        await new Promise(resolve => setTimeout(resolve, 1500));

        let risk = 'normal';
        let riskLevel = '–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫';
        let message = '–ò–∑–Ω–æ—Å –∑–¥–∞–Ω–∏—è –≤ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö';

        if (wearPercent > 70) {
          risk = 'high';
          riskLevel = '–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫';
          message = '–ò–∑–Ω–æ—Å –∑–¥–∞–Ω–∏—è –ø—Ä–µ–≤—ã—à–∞–µ—Ç 70%. –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞.';
        } else if (wearPercent > 50) {
          risk = 'medium';
          riskLevel = '–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫';
          message = '–ò–∑–Ω–æ—Å –∑–¥–∞–Ω–∏—è –ø—Ä–µ–≤—ã—à–∞–µ—Ç 50%. –í–æ–∑–º–æ–∂–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏.';
        }

        showResult('wear-results', {
          icon: risk === 'high' ? '‚ö†Ô∏è' : risk === 'medium' ? '‚ö°' : '‚úÖ',
          title: '–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–Ω–æ—Å–∞',
          message: `–ì–æ—Ä–æ–¥: ${city}\n–£–ª–∏—Ü–∞: ${street}\n–î–æ–º: ${house}\n–ò–∑–Ω–æ—Å: ${wearPercent}%\n\n${message}`,
          risk: risk,
          riskLevel: riskLevel
        });
      } catch (error) {
        showResult('wear-results', {
          icon: '‚ùå',
          title: '–û—à–∏–±–∫–∞',
          message: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ',
          details: error.message,
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
      }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ï–ì–†–ù
    window.checkEGRN = async function() {
      const fileInput = document.getElementById('egrn-file');
      const file = fileInput?.files[0];

      if (!file) {
        showResult('egrn-results', {
          icon: '‚ö†Ô∏è',
          title: '–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω',
          message: '–í—ã–±–µ—Ä–∏—Ç–µ XML —Ñ–∞–π–ª –≤—ã–ø–∏—Å–∫–∏ –ï–ì–†–ù',
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
        return;
      }

      showLoading('egrn-results', '–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ñ–∞–π–ª –≤—ã–ø–∏—Å–∫–∏ –ï–ì–†–ù...');

      try {
        const result = await analyzeEGRNFile(file);
        showResult('egrn-results', result);
      } catch (error) {
        showResult('egrn-results', {
          icon: '‚ùå',
          title: '–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–∞',
          message: '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–∞–π–ª –ï–ì–†–ù',
          details: error.message,
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
      }
    }

    function analyzeEGRNFile(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const xmlText = e.target.result;
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
            const parseError = xmlDoc.querySelector('parsererror');
            if (parseError) {
              throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç XML —Ñ–∞–π–ª–∞');
            }

            const restrictions = xmlDoc.querySelectorAll('Restriction, restriction');
            const encumbrances = xmlDoc.querySelectorAll('Encumbrance, encumbrance');
            const seizures = xmlDoc.querySelectorAll('*[contains(text(), "–∏–∑—ä—è—Ç–∏–µ")], *[contains(text(), "seizure")]');

            let issues = [];
            let risk = 'normal';
            let riskLevel = '–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫';
            let message = '–§–∞–π–ª –ï–ì–†–ù —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω';

            if (restrictions.length > 0) {
              issues.push(`–ù–∞–π–¥–µ–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–∞–≤: ${restrictions.length}`);
              risk = 'high';
              riskLevel = '–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫';
            }

            if (encumbrances.length > 0) {
              issues.push(`–ù–∞–π–¥–µ–Ω—ã –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏—è: ${encumbrances.length}`);
              risk = 'high';
              riskLevel = '–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫';
            }

            if (seizures.length > 0) {
              issues.push('–ï—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ–± –∏–∑—ä—è—Ç–∏–∏ –æ–±—ä–µ–∫—Ç–∞');
              risk = 'high';
              riskLevel = '–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫';
            }

            if (issues.length === 0) {
              message += '. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.';
            } else {
              message += '. –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã: ' + issues.join(', ') + '.';
            }

            resolve({
              icon: 'üìã',
              title: '–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –ï–ì–†–ù',
              message: message,
              risk: risk,
              riskLevel: riskLevel
            });
          } catch (error) {
            reject(error);
          }
        };
        reader.onerror = () => reject(new Error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞'));
        reader.readAsText(file);
      });
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞
    window.checkBankruptcy = async function() {
      const fio = document.getElementById('bankruptcy-fio').value.trim();

      if (!fio) {
        showResult('bankruptcy-results', {
          icon: '‚ö†Ô∏è',
          title: '–§–ò–û –Ω–µ —É–∫–∞–∑–∞–Ω–æ',
          message: '–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω–æ–µ –§–ò–û –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏',
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
        return;
      }

      showLoading('bankruptcy-results', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ï–§–†–°–ë...');

      try {
        await new Promise(resolve => setTimeout(resolve, 2500));
        const hasBankruptcy = Math.random() > 0.8;

        if (hasBankruptcy) {
          showResult('bankruptcy-results', {
            icon: '‚öñÔ∏è',
            title: '–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞',
            message: '–ù–∞–π–¥–µ–Ω–æ –¥–µ–ª–æ –æ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–µ. –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞.',
            details: '–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–º—É –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç—É',
            risk: 'high',
            riskLevel: '–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫'
          });
        } else {
          showResult('bankruptcy-results', {
            icon: '‚úÖ',
            title: '–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞',
            message: '–î–µ–ª–∞ –æ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã',
            risk: 'normal',
            riskLevel: '–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫'
          });
        }
      } catch (error) {
        showResult('bankruptcy-results', {
          icon: '‚ùå',
          title: '–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏',
          message: '–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞',
          details: error.message,
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
      }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –§–°–°–ü
    window.checkFSSP = async function() {
      const fio = document.getElementById('fssp-fio').value.trim();
      const birthDate = document.getElementById('fssp-birth').value;
      const region = document.getElementById('fssp-region').value;

      if (!fio || !birthDate || !region) {
        showResult('fssp-results', {
          icon: '‚ö†Ô∏è',
          title: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö',
          message: '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è: –§–ò–û, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ —Ä–µ–≥–∏–æ–Ω',
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
        return;
      }

      showLoading('fssp-results', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –§–°–°–ü...');

      try {
        await new Promise(resolve => setTimeout(resolve, 3000));
        const hasDebts = Math.random() > 0.7;
        const debtAmount = hasDebts ? Math.floor(Math.random() * 500000) + 10000 : 0;

        if (hasDebts) {
          showResult('fssp-results', {
            icon: 'üöî',
            title: '–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –§–°–°–ü',
            message: `–ù–∞–π–¥–µ–Ω—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –Ω–∞ —Å—É–º–º—É ${debtAmount.toLocaleString('ru-RU')} ‚ÇΩ`,
            details: '–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≥–∞—à–µ–Ω–∏–µ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ–º',
            risk: 'high',
            riskLevel: '–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫'
          });
        } else {
          showResult('fssp-results', {
            icon: '‚úÖ',
            title: '–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –§–°–°–ü',
            message: '–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã',
            risk: 'normal',
            riskLevel: '–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫'
          });
        }
      } catch (error) {
        showResult('fssp-results', {
          icon: '‚ùå',
          title: '–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏',
          message: '–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –§–°–°–ü',
          details: error.message,
          risk: 'error',
          riskLevel: '–û—à–∏–±–∫–∞'
        });
      }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
    document.addEventListener('DOMContentLoaded', function() {
      const healthBtn = document.getElementById('health-calculate-btn');
      const wearBtn = document.getElementById('wear-calculate-btn');
      const modal = document.getElementById('underwriting-modal');

      if (healthBtn) {
        healthBtn.addEventListener('click', calculateHealthUnderwriting);
      }

      if (wearBtn) {
        wearBtn.addEventListener('click', calculateBuildingRisk);
      }

      if (modal) {
        modal.addEventListener('click', function(e) {
          if (e.target === modal) {
            closeUnderwritingModal();
          }
        });
      }

      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal && modal.style.display === 'flex') {
          closeUnderwritingModal();
        }
      });
    });
  </script>
</body>
</html>
